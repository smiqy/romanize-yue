"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var r=0,c=new Array(e.length);r<e.length;r++)c[r]=e[r];return c}}function _slicedToArray(e,r){return _arrayWithHoles(e)||_iterableToArrayLimit(e,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,r){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var c=[],n=!0,a=!1,t=void 0;try{for(var u,i=e[Symbol.iterator]();!(n=(u=i.next()).done)&&(c.push(u.value),!r||c.length!==r);n=!0);}catch(e){a=!0,t=e}finally{try{n||null==i.return||i.return()}finally{if(a)throw t}}return c}}function _arrayWithHoles(e){if(Array.isArray(e))return e}var fs=require("fs"),pathEmc="rime-middle-chinese/zyenpheng.dict.yaml",textEmc=fs.readFileSync(pathEmc,"utf8"),reduceReplace=function(e,r){return r.reduce(function(e,r){var c=_slicedToArray(r,2),n=c[0],a=c[1];return e.replace(n,a)},e)},textEmcNew=textEmc.split("\n").filter(function(e){return/^(?:[\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u3005\u3007\u3021-\u3029\u3038-\u303B\u3400-\u4DB5\u4E00-\u9FEF\uF900-\uFA6D\uFA70-\uFAD9]|[\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D])\t/g.test(e)}).slice(31).join("\n").replace(/[a-z']+/g,function(e){var r=0,c=e;return/x$/.test(c)?(r=1,c=c.slice(0,-1)):/h$/.test(c)?(r=2,c=c.slice(0,-1)):/d$/.test(c)?r=2:/[ktp]$/.test(c)&&(r=3),((c=[[/ng/g,"ŋ"],[/k$/,"ŋ"],[/t$/,"n"],[/p$/,"m"],[/h/,"x"],[/^z(?!s)/,"ʣ"],[/^c/,"ʦ"],[/^zs/,"z"],[/^gx/,"h"],[/(?<!^)xr/,"rx"],[/xj/,"jx"],[/^k/,"c"],[/xj/,"j"],[/xj/,"jx"]].reduce(function(e,r){var c=_slicedToArray(r,2),n=c[0],a=c[1];return e.replace(n,a)},c))+r).normalize("NFC")}),emc={};textEmcNew.split("\n").map(function(e){return e.trim().split("\t")}).filter(function(e){return 1==_slicedToArray(e,1)[0].length}).map(function(e){var r,c=_slicedToArray(e,3),n=c[0],a=c[1],t=c[2];(!t||30<=parseInt(t.match(/(\d+)%/)))&&(r=a.match(/(.+)(\d)/).slice(1),emc[n]?emc[n].push(r):emc[n]=[r])}),fs.writeFileSync("../docs/romanization-emc.js","const mapEmc = {\n".concat(Object.entries(emc).map(function(e){var r=_slicedToArray(e,2),c=r[0],n=r[1];return'  "'.concat(c,'": [').concat(n.map(function(e){var r=_slicedToArray(e,2),c=r[0],n=r[1];return'"'.concat(c.replace(/j/g,"ȷ").replace(/i/g,"ı")).concat("̄́̀̍".charAt(parseInt(n)),'"')}).join(", "),"]")}).join(",\n"),"\n};")),pathYue="jyutping-table/list.tsv",textYue=fs.readFileSync(pathYue,"utf8");var voice=function(e){return{g:"c",d:"t","ʣ":"ʦ",b:"p"}[e]},yue={};textYue.trim().split("\r\n").slice(1).map(function(e){var r=_slicedToArray(e.split("\t"),6),c=r[0],n=(r[1],r[2]),a=(r[3],r[4],r[5]),t=n.replace(/[1-6]$/,"");if(1==t.split(" ").length&&(!/[ktp]$/.test(t)||["1","3","6"].includes(a))&&"ngm"!=t){/[ktp]$/.test(t)&&(a={1:"7",3:"7",6:"8"}[a],t=t.replace(/k$/,"ng").replace(/t$/,"n").replace(/p$/,"m")),t=t.replace(/^k/,"kh").replace(/^t/,"th").replace(/^c/,"ch").replace(/^p/,"ph").replace(/^g/,"k").replace(/^d/,"t").replace(/^z/,"c").replace(/^b/,"p").replace(/ng/g,"ŋ").replace(/yu/,"y").replace(/oe|eo/,"ø").replace(/j(?=[iyø])/,"").replace(/w/,"v").replace(/v(?=u)/,"").replace(/a/g,"ə").replace(/əə/,"a").replace(/c/,"ʦ").replace(/z/,"ʣ").replace(/k/g,"c").replace(/h/,"x"),t=["1","2","3","7"].includes(a=a)?t.replace(/^(?=[ŋnmljviyueøoəa])/,"q"):t.replace(/^s/,"z").replace(/^x/,"h").replace(/^f/,"w").replace(/^p/,"b").replace(/^c/,"g").replace(/^t/,"d").replace(/^ʦ/,"ʣ"),a={1:0,2:1,3:2,4:0,5:1,6:2,7:3,8:3}[a];var u=emc[c];if(u&&1<=u.length){for(var i=0,l=["ŋ","n","m"];i<l.length;i++){if("break"===function(){var r=l[i];if(u.some(function(e){return new RegExp("^"+r).test(e[0])}))return t=t.replace(/(?<=^q?)(?=[iyueøoaəjv])/,"".concat(r,"’")),"break"}())break}t=t.replace(/n’j/,"nj").replace(/(?<=n)’(?=[iyø])/,"j").replace(/(?<=ŋ)’(?=[iyj])/,"");for(var o=0,p=[[/^[dtʣʦzs]j/,/(?<=^[ʣʦzs])/,"j"],[/^[dtʣʦzs]r/,/(?<=^[ʣʦzs])/,"r"],[/^[gchx]/,/^f/,"xv"],[/^[gchx]/,/^w/,"hv"],[/^[gcxh]/,/(?=^[iyueøoəajv])/,"h’"],[/^[gcxh]/,/^q(?=[iyueøoəajv])/,"x’"]];o<p.length;o++){if("break"===function(){var e=_slicedToArray(p[o],3),r=e[0],c=e[1],n=e[2];if(u.every(function(e){return r.test(e[0])})&&c.test(t))return t=t.replace(c,n),"break"}())break}t=t.replace(/(?<=^h)’(?=[jvy])/,"").replace(/’(?=u)/,"v").replace(/(?<=[xh])v(?=u)/,"").replace(/’(?=[iyø])/,"j").replace(/(?<=^[xnm])’(?=j)/,"").replace(/(?<=^ŋ)’(?=[jiyø])/,"").replace(/(?<=[ŋnm])’(?=v)/,"").replace(/(?<=ŋ)’(?=[iyueøoəa])/,"")}t=(t=t.replace(/(?<!^)xv/,"vx").replace(/(?<!^)xj/,"jx").replace(/(?<!^)xr/,"rx")).replace(/j/,"ȷ").replace(/i/,"ı"),n=t+["̀","́","̄","̍"][a],u&&(/^q?ŋ/.test(t)&&!u.some(function(e){return/^ŋ/.test(e[0])})||/^q?n/.test(t)&&!u.some(function(e){return/^n/.test(e[0])})||/^q?m/.test(t)&&!u.some(function(e){return/^m/.test(e[0])}))||(yue[c]?yue[c].includes(n)||yue[c].some(function(e){return e.replace(/.$/,"")==n.replace(/q(?=[ŋnml])/,"").replace(/.$/,"")})||yue[c].some(function(e){return e.replace(/.$/,"")==n.replace(/(?<=[gdʣb][rj]?)x/,"").replace(/.$/,"")})||yue[c].some(function(e){return e.replace(/.$/,"")==n.replace(/^./,voice).replace(/.$/,"")})||yue[c].some(function(e){return e==n.replace(/^l/,"n")})||yue[c].some(function(e){return e.replace(/.$/,"")==n.replace(/^ql(.+).$/,"n$1")})||yue[c].includes(n.replace(/(?<=[cg]x?)/,"v"))||yue[c].push(n):yue[c]=[n])}}),fs.writeFileSync("../docs/romanization-yue.js","const mapYue = {\n".concat(Object.entries(yue).map(function(e){var r=_slicedToArray(e,2),c=r[0],n=r[1];return'  "'.concat(c,'": [').concat(n.map(function(e){return'"'.concat(e,'"')}).join(", "),"]")}).join(",\n"),"\n};"));var yueToSimple=function(e){var r=_slicedToArray(e.normalize("NFD").match(/(.+)(.)/),3),c=(r[0],r[1]),n=r[2],c=c.replace(/ı/g,"i").replace(/ȷ/g,"j"),n=(/^[bwmdznlʣghŋjviyueøoəa]/.test(c)?["̀","̌","᷅","̏"]:["̂","́","̄","̋"])[["̀","́","̄","̍"].indexOf(n)];return((c=c.replace(/g/g,"c").replace(/h/g,"x").replace(/d/g,"t").replace(/ʣ/g,"ʦ").replace(/z/g,"s").replace(/b/g,"p").replace(/w/g,"f").replace(/q/g,"").replace(/c(?!x)/g,"g").replace(/t(?!x)/g,"d").replace(/ʦ(?![jr]?x)/g,"ʣ").replace(/p(?!x)/g,"b").replace(/(?<=(c|t|ʦ[jr]|p))x/g,"").replace(/ʣ/g,"z").replace(/c/g,"k").replace(/ʦ/g,"c").replace(/z[jr]/g,"ᵶ").replace(/c[jr]/g,"ꞓ").replace(/s[jr]/g,"ꞩ").replace(/i/g,"ı").replace(/j/g,"ȷ"))+n).normalize("NFC")};fs.writeFileSync("../docs/romanization-yue-simple.js","const mapYueSimple = {\n".concat(Object.entries(yue).map(function(e){var r=_slicedToArray(e,2),c=r[0],n=r[1];return'  "'.concat(c,'": [').concat(n.map(function(e){return'"'.concat(yueToSimple(e),'"')}).join(", "),"]")}).join(",\n"),"\n};"));var yueToIpa=function(e){var r=_slicedToArray(e.normalize("NFD").match(/(.+)(.)/),3),c=(r[0],r[1]),n=r[2],c=c.replace(/ı/g,"i").replace(/ȷ/g,"j"),n=["̀","́","̄","̍"].indexOf(n);voiced=/^[bwmdznlʣghŋjviyueøoəa]/.test(c),c=c.replace(/i/,"iː").replace(/oi$/,"ɔːy").replace(/o(?!u$)/,"ɔː").replace(/e(?!i$)/,"ɛː").replace(/y/,"yː").replace(/øi$/,"ɵy").replace(/ø(?=n$)/,"ɵ").replace(/ø/,"œː").replace(/^q/,"").replace(/^[gc]/,"k").replace(/^[hx]/,"h").replace(/x/,"ʰ").replace(/^[dt]/,"t").replace(/^[ʣʦ]r/,"ʈʂ").replace(/^[zs]r/,"ʂ").replace(/^[ʣʦ]j/,"tɕ").replace(/^[zs]j/,"ɕ").replace(/^nj/,"ɲ").replace(/^[ʣʦ]/,"ts").replace(/^[wf]/,"f").replace(/^v/,"W").replace(/v/,"ʷ").replace(/^m$/,"m̩").replace(/^ŋ$/,"ŋ̍"),3==n&&(c=c.replace(/(?<!^)ŋ$/,"k̚").replace(/(?<!^)n$/,"t̚").replace(/(?<!^)m$/,"p̚"));var a=!/ː/.test(c);return(c+(n=(voiced?["˧˩","˩˧","˩","˩"]:["˥˧","˧˥","˧",a?"˥":"˧"])[n])).normalize("NFC")};fs.writeFileSync("../docs/romanization-yue-ipa.js","const mapYueIpa = {\n".concat(Object.entries(yue).map(function(e){var r=_slicedToArray(e,2),c=r[0],n=r[1];return'  "'.concat(c,'": [').concat(n.map(function(e){return'"'.concat(yueToIpa(e),'"')}).join(", "),"]")}).join(",\n"),"\n};"));for(var pinyin=require("pinyin/data/dict-zi"),cmn={},_loop3=function(){var e,r=_slicedToArray(_Object$entries[_i4],2),c=r[0],n=r[1],p=String.fromCharCode(c);p.match(/(?:[\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u3005\u3007\u3021-\u3029\u3038-\u303B\u3400-\u4DB5\u4E00-\u9FEF\uF900-\uFA6D\uFA70-\uFAD9]|[\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D])/)&&(cmn[p]||(cmn[p]=[]),e=n.split(",").map(function(e){var r={"̄":"́","́":"̌","̌":"̀","̀":"̂",null:"̇"}[(e=e.normalize("NFD")).match(/[\u0304\u0301\u030C\u0300]/)],c=reduceReplace(e.replace(/[\u0304\u0301\u030C\u0300]/,"").normalize("NFC"),[[/ng$/,"ŋ"],[/(?<=^[zcs])h/,"r"],[/(?<=[zcsr])i/,""],[/(?<=^[bpmf])o/,"uo"],[/(?<=^[jqx])u/,"ü"],[/^j/,"g"],[/^q/,"k"],[/^h/,"x"],[/^yi/,"i"],[/^yu/,"ü"],[/^wu/,"u"],[/y/,"i"],[/ü/,"y"],[/w/,"u"],[/ioŋ$/,"yeŋ"],[/ao$/,"au"],[/ou$/,"eu"],[/uo$/,"ue"],[/(?<=[iy])(?=[ŋn]$)/,"e"],[/iu$/,"ieu"],[/ui$/,"uei"],[/un$/,"uen"],[/oŋ$/,"ueŋ"],[/c/g,"ʦ"],[/z/g,"ʣ"],[/k/g,"c"]]),n=emc[p];if(n&&1<=n.length){n.some(function(e){return/^m/.test(e[0])})?c=c.replace(/^(?=u)/,"m"):n.some(function(e){return/^ŋ/.test(e[0])})?c=c.replace(/^(?=[iyuea])/,"ŋ"):n.some(function(e){return/^nr/.test(e[0])})?c=c.replace(/^r/,"nr").replace(/^er$/,"enr"):n.some(function(e){return/^n[ij]/.test(e[0])})?c=c.replace(/^r/,"nj").replace(/^er$/,"enj"):n.some(function(e){return/^[ij]/.test(e[0])})&&(c=c.replace(/^r/,"j").replace(/^er$/,"ej")),n.some(function(e){return/^[ʣʦsz]r/.test(e[0])})?c=c.replace(/^g(?=[iy])/,"ʣr").replace(/^c(?=[iy])/,"ʦr").replace(/^x(?=[iy])/,"sr"):n.some(function(e){return/^[ʣʦsz]j/.test(e[0])})?c=c.replace(/^g(?=[iy])/,"ʣj").replace(/^c(?=[iy])/,"ʦj").replace(/^x(?=[iy])/,"sj").replace(/(?<=^[ʣʦs])r/,"j"):n.some(function(e){return/^[ʣʦsz]/.test(e[0])})&&(c=c.replace(/^g(?=[iy])/,"ʣ").replace(/^c(?=[iy])/,"ʦ").replace(/^x(?=[iy])/,"s"));var a=!0,t=!1,u=void 0;try{for(var i,l=n[Symbol.iterator]();!(a=(i=l.next()).done);a=!0){var o=i.value;if(/[ŋnm]$/.test(o[0])&&3==o[1]){c+={"ŋ":"c",n:"t",m:"p"}[o[0].slice(-1)];break}}}catch(e){t=!0,u=e}finally{try{a||null==l.return||l.return()}finally{if(t)throw u}}}return((c=c.replace(/i/g,"ı").replace(/j/g,"ȷ"))+r).normalize("NFC")}),cmn[p]=cmn[p].concat(e))},_i4=0,_Object$entries=Object.entries(pinyin);_i4<_Object$entries.length;_i4++)_loop3();fs.writeFileSync("../docs/romanization-cmn.js","const mapCmn = {\n".concat(Object.entries(cmn).map(function(e){var r=_slicedToArray(e,2),c=r[0],n=r[1];return'  "'.concat(c,'": [').concat(n.map(function(e){return'"'.concat(e,'"')}).join(", "),"]")}).join(",\n"),"\n};"));var cmnToSimple=function(e){return e.normalize("NFD").replace(/ı/g,"i").replace(/ȷ/g,"j").replace(/e(?=[ŋnm])/,"").replace(/(?=[iuy])e(?=[iu])/,"").replace(/c/g,"k").replace(/ʣ/g,"z").replace(/ʦ/g,"c").replace(/z[rj]/,"ẓ").replace(/c[rj]/,"c̣").replace(/s[rj]/,"ṣ").replace(/[ktp](?=.$)/,"").replace(/i/g,"ı").replace(/j/g,"ȷ").normalize("NFC")};fs.writeFileSync("../docs/romanization-cmn-simple.js","const mapCmnSimple = {\n".concat(Object.entries(cmn).map(function(e){var r=_slicedToArray(e,2),c=r[0],n=r[1];return'  "'.concat(c,'": [').concat(n.map(function(e){return'"'.concat(cmnToSimple(e),'"')}).join(", "),"]")}).join(",\n"),"\n};"));for(var _i5=0,_arr4=["yue","cmn"];_i5<_arr4.length;_i5++)for(var lang=_arr4[_i5],_i6=0,_arr5=["","-simple","-ipa"];_i6<_arr5.length;_i6++){var suffix=_arr5[_i6];fs.copyFile("../docs/romanization-".concat(lang).concat(suffix,".js"),"../plugin/romanization-".concat(lang).concat(suffix,".js"),function(e){e&&console.log(e)})}console.log(_toConsumableArray("完了").map(function(e){return yue[e][0]}).join(""));